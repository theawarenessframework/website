<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Awareness Framework</title>
    
    <!-- === FAVICON INCLUSION === -->
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <!-- === Structured Data (JSON-LD) for Search Engine Indexing (ISBN included) === -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Book",
      "name": "The Awareness Framework",
      "author": [
        {
          "@type": "Person",
          "name": "Sanjeev Khanal"
        },
        {
          "@type": "Person",
          "name": "Raheel Budha"
        }
      ],
      "isbn": "9789937192835",
      "bookEdition": "1st Edition",
      "bookFormat": "Paperback",
      "description": "A profound system that merges philosophy, quantum physics, consciousness study and system-thinking to redefine how you understand existence, purpose, and self-organization. It provides you with a new perspective to see the life, existence and everything in-between.",
      "image": "book.png"
    }
    </script>

    <style>
        /* Custom Colors & Fonts */
        :root {
            --color-primary: #0D1137; /* Deep Indigo - For text and accents (now used for all CTAs) */
            --color-secondary: #F7F8FC; /* Pale Blue-Gray - For subtle section backgrounds */
            --color-accent: #FFC107; /* Vibrant Gold - Secondary color, now used only for highlights */
            --color-footer: #1C2438; /* Dark Charcoal - For footer */
            --font-heading: 'Playfair Display', serif;
            --font-body: 'Inter', sans-serif;
            --content-opacity: 0.95; 
        }

        body {
            font-family: var(--font-body);
            color: var(--color-primary);
            background-color: #FFFFFF;
        }

        h1, h2, h3, h4 {
            font-family: var(--font-heading);
            color: var(--color-primary);
        }

        /* Utility Classes for Canvas and Wave Animation */
        #awarenessCanvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: -1; 
            pointer-events: none;
        }
        
        .section-transparent-white {
            background-color: rgba(255, 255, 255, var(--content-opacity)); 
        }

        .section-transparent-secondary {
            background-color: rgba(247, 248, 252, var(--content-opacity)); 
        }

        .header-transparent {
            background-color: rgba(255, 255, 255, var(--content-opacity));
        }

        .footer-transparent-dark {
            background-color: rgba(28, 36, 56, var(--content-opacity));
        }
        
        .text-primary-custom {
            color: var(--color-primary);
        }

        .hero-section {
            position: relative; 
            overflow: hidden; 
        }
        
        .hero-content {
            position: relative;
            z-index: 10; 
        }
        
        /* Modal Overlay Styling */
        .modal-overlay {
            background-color: rgba(13, 17, 55, 0.9); /* Darker indigo overlay */
            transition: opacity 0.3s ease;
        }

        /* Custom scrollbar for confirmation details */
        .confirmation-scroll {
            max-height: 250px;
            overflow-y: auto;
        }

        /* Input styling for quantity */
        input[type="number"] {
            -webkit-appearance: none;
            -moz-appearance: textfield;
            appearance: textfield;
            text-align: center;
        }
    </style>
</head>

<body class="min-h-screen">
    <!-- === FIXED BACKGROUND CANVAS === -->
    <canvas id="awarenessCanvas"></canvas>

    <!-- === 1. HEADER & NAVIGATION === -->
    <header class="sticky top-0 z-50 header-transparent border-b border-gray-100 shadow-lg">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center max-w-7xl">
            
            <!-- LEFT SECTION: Mobile Menu Button & H1 -->
            <div class="flex items-center gap-4">
                 <!-- Mobile Menu Button (Hamburger on Left) -->
                <button id="mobile-menu-button" 
                    class="md:hidden p-3 rounded-full bg-accent shadow-xl hover:bg-yellow-500 transition duration-300 focus:outline-none z-50">
                    <svg class="w-6 h-6 text-primary-custom" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
                <h1 class="text-xl sm:text-2xl font-bold tracking-tight text-primary-custom">The Awareness Framework</h1>
            </div>

            <!-- CENTER: Desktop Nav -->
            <nav id="nav-menu" class="hidden md:flex space-x-8 text-sm font-medium">
                <a href="#hero" class="hover:text-gray-600 transition duration-150">Exploration</a>
                <a href="#domains" class="hover:text-gray-600 transition duration-150">The Scope</a>
                <a href="#authors" class="hover:text-gray-600 transition duration-150">Authors</a>
                <a href="#contact" class="hover:text-gray-600 transition duration-150">Contact</a>
            </nav>
            
            <!-- RIGHT SECTION: Desktop CTA Button (Now calling JS function) -->
            <div class="">
                <!-- Updated button to call the new flow function -->
                <button onclick="showModal(1)"
                    class="border-2 border-[var(--color-primary)] text-[var(--color-primary)] bg-white py-2 px-6 text-sm font-bold rounded-lg transition duration-300 transform hover:scale-[1.05] hover:bg-[var(--color-primary)] hover:text-white">
                    Buy Now
                </button>
            </div>
        </div>

        <!-- Mobile Dropdown Menu: Hidden by default and hidden on MD+ -->
        <nav id="mobile-nav" class="hidden md:hidden px-6 py-2 border-t border-gray-100 header-transparent">
            <a href="#hero" class="block py-2 text-sm font-medium hover:bg-gray-50 transition duration-150">Exploration</a>
            <a href="#domains" class="block py-2 text-sm font-medium hover:bg-gray-50 transition duration-150">The Scope</a>
            <a href="#authors" class="block py-2 text-sm font-medium hover:bg-gray-50 transition duration-150">Authors</a>
            <a href="#contact" class="block py-2 text-sm font-medium hover:bg-gray-50 transition duration-150">Contact</a>
        </nav>
    </header>


    <!-- === 2. HERO SECTION (Exploration - Now clean) === -->
    <section id="hero" class="hero-section section-transparent-white pt-16 pb-20 md:pt-24 md:pb-32 text-center">
        <div class="hero-content max-w-5xl mx-auto px-6">
            <!-- HEADING -->
            <h2 class="text-4xl sm:text-5xl md:text-6xl font-bold tracking-tight mb-4">
                The Awareness Framework
            </h2>
            <!-- SUBHEADING/HOOK TEXT -->
            <p class="text-lg sm:text-xl italic font-light max-w-3xl mx-auto mb-16 text-gray-700 text-justify">
                We invite you to explore reality through a new lens, where <strong>the observer is</strong> not the by-product of existence but rather the fundamental fabric upon which reality unfolds. We offer this not as a doctrine, but as a new perspective where everything seems connected and self-sustaining.
            </p>

            <!-- BOOK COVER (Centered) -->
            <div class="flex flex-col items-center justify-center">
                <!-- Book Cover: Image now only acts as a visual element -->
                <img src="book.png" alt="Book cover of The Awareness Framework"
                    class="w-64 md:w-80 h-auto shadow-2xl rounded-lg transform hover:scale-[1.03] transition duration-300"
                    onerror="this.onerror=null; this.src='https://placehold.co/320x500/cccccc/333333?text=Book+Cover';"
                >

                <!-- Order Message Area (for feedback after confirmation) -->
                <div id="order-message-area" class="mt-6 w-full max-w-xs md:max-w-md min-h-[40px] flex items-center justify-center">
                    <!-- Success/Error messages appear here -->
                </div>
            </div>
        </div>
    </section>

    <!-- === 3. CORE BOOK INSIGHTS (Reworked Domain Cards) === -->
    <section id="domains" class="section-transparent-secondary py-20 md:py-28">
        <div class="max-w-7xl mx-auto px-6">
            <h3 class="text-3xl sm:text-4xl font-bold text-center mb-16 tracking-tight">
                Core Book Insights
            </h3>

            <!-- 8 Insight Cards in a Responsive Grid -->
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                
                <!-- Insight 1: Observer as a Base -->
                <div class="bg-white p-6 rounded-xl shadow-lg border-l-4 border-accent opacity-95">
                    <h4 class="text-lg font-bold mb-2">The Observer as Base</h4>
                    <p class="text-sm text-gray-600">
                        The fundamental concept that the Observer is the primary foundation, defined as a non-energetic informational constant. Consciousness is considered a byproduct of the Observer's interaction with the system, establishing the core system architecture.
                    </p>
                </div>

                <!-- Insight 2: Nature of Reality (R=OMP) -->
                <div class="bg-white p-6 rounded-xl shadow-lg border-l-4 border-accent opacity-95">
                    <h4 class="text-lg font-bold mb-2">Reality: R=OMP (Observer, Memory, Pattern)</h4>
                    <p class="text-sm text-gray-600">
                        Introducing the core equation that defines structural reality: <strong>Reality = Observer + Memory + Pattern</strong>. This principle highlights how Pattern analysis is the active step that gives rise to the perception of reality.
                    </p>
                </div>
                
                <!-- Insight 3: Causality, Time, and Space -->
                <div class="bg-white p-6 rounded-xl shadow-lg border-l-4 border-accent opacity-95">
                    <h4 class="text-lg font-bold mb-2">Causality, Time, and Space</h4>
                    <p class="text-sm text-gray-600">
                        An exploration of how the observer's internal system (Memory) creates the perception of linear time and dimensional space.
                    </p>
                </div>
                
                <!-- Insight 4: Coherence and Balance -->
                <div class="bg-white p-6 rounded-xl shadow-lg border-l-4 border-accent opacity-95">
                    <h4 class="text-lg font-bold mb-2">Coherence and Balance</h4>
                    <p class="text-sm text-gray-600">
                        The essential requirement for systemic health, achieved through the dynamic equilibrium between exploration (vastness) and clarity (precision).
                    </p>
                </div>
                
                <!-- Insight 5: Alignment -->
                <div class="bg-white p-6 rounded-xl shadow-lg border-l-4 border-accent opacity-95">
                    <h4 class="text-lg font-bold mb-2">The Principle of Alignment</h4>
                    <p class="text-sm text-gray-600">
                        Defining the state of internal coherence where the system's inherent duality (Memory and Pattern) is balanced, ensuring the system is internally consistent and self-sufficient.
                    </p>
                </div>

                <!-- Insight 6: Biology and Nature of Life -->
                <div class="bg-white p-6 rounded-xl shadow-lg border-l-4 border-accent opacity-95">
                    <h4 class="text-lg font-bold mb-2">Biology and Nature of Life</h4>
                    <p class="text-sm text-gray-600">
                        Examining life through the lens of system architecture: the minimum necessary structure required for self-sustaining coherence against entropy.
                    </p>
                </div>
                
                <!-- Insight 7: Extension of Humanity -->
                <div class="bg-white p-6 rounded-xl shadow-lg border-l-4 border-accent opacity-95">
                    <h4 class="text-lg font-bold mb-2">Extension of Human System</h4>
                    <p class="text-sm text-gray-600">
                        How the Framework applies beyond the individual, influencing societal structures, technology, and collective awareness.
                    </p>
                </div>
                
                <!-- Insight 8: Ethics and Health -->
                <div class="bg-white p-6 rounded-xl shadow-lg border-l-4 border-accent opacity-95">
                    <h4 class="text-lg font-bold mb-2">Ethics through System Health</h4>
                    <p class="text-sm text-gray-600">
                        Establishing a new ethical framework rooted in maintaining systemic coherence, health, and minimum entropy (the opposite of disorder).
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- === 4. CORE PHILOSOPHY & QUOTE === -->
    <section class="section-transparent-white py-20 md:py-28">
        <div class="max-w-4xl mx-auto px-6 text-center">
            <p class="text-2xl md:text-3xl italic font-light text-gray-800 leading-relaxed border-y-2 border-gray-200 py-6">
                "The universe is not a scattered orchestra of parts but a single composition in motion: each particle, pattern, and pulse contributing to a music vast enough to include its own silence."
            </p>
            <!-- Bolded book name -->
            <p class="text-lg mt-8 font-medium text-gray-500">
                — A core tenet of <strong>The Awareness Framework</strong>
            </p>
        </div>
    </section>

    <!-- === 5. MEET THE AUTHORS === -->
    <section id="authors" class="section-transparent-secondary py-20 md:py-28">
        <div class="max-w-7xl mx-auto px-6">
            <h3 class="text-3xl sm:text-4xl font-bold text-center mb-16 tracking-tight">
                Meet the Authors
            </h3>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-12 md:gap-20">
                <!-- Author 1: Sanjeev Khanal -->
                <div class="flex flex-col items-center text-center">
                    <img src="sanjeev.png" alt="Sanjeev Khanal Headshot"
                        class="w-36 h-36 rounded-full object-cover border-4 border-accent shadow-md mb-6"
                        onerror="this.onerror=null; this.src='https://placehold.co/150x150/EEEEEE/333333?text=Sanjeev';"
                    >
                    <h4 class="text-2xl font-bold mb-2">Sanjeev Khanal</h4>
                    <p class="text-sm italic text-gray-500 mb-4">Mind Drawn to Vastness (Exploration)</p>
                    <!-- Justified paragraph -->
                    <p class="text-gray-600 mb-4 text-justify">
                        A mind drawn to vastness: to take the smallest spark of thought and project it toward infinity. Sanjeev sees patterns where others see parts, weaving intuition with quiet reasoning. To him, awareness is a living field, one that breathes through everything that exists. His exploration continues as an open inquiry into how observation shapes the unfolding of experience.
                    </p>
                    <!-- Social Icons for Sanjeev -->
                    <div class="flex space-x-5 text-primary-custom">
                        <!-- Facebook Icon (Standard Path) -->
                        <a href="[Sanjeev's Facebook]" target="_blank" class="hover:text-accent transition duration-150">
                            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12c0 4.84 3.44 8.87 8 9.8V15H7v-3h3V9.5C10 6.47 11.53 4.7 15.56 4.7c1.78 0 3.3.32 3.3.32v3.3h-1.68c-1.54 0-2.02.96-2.02 1.96V12h3.6l-.58 3h-3.02v6.8c4.56-.93 8-4.84 8-9.8z"/></svg>
                        </a>
                        <!-- LinkedIn Icon (Standard Path) -->
                        <a href="[Sanjeev's LinkedIn]" target="_blank" class="hover:text-accent transition duration-150">
                            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M19 3a2 2 0 012 2v14a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h14zM8 12H5V9h3v3zM6.5 7.5A1.5 1.5 0 005 9.01v.01A1.5 1.5 0 006.5 10.5h.01A1.5 1.5 0 008 9.01v-.01A1.5 1.5 0 006.5 7.5zm11 10.5h-3V14c0-1.24-.54-2-1.2-2.75-.66-.74-1.52-1.25-2.5-1.25s-1.84.51-2.5 1.25c-.66.75-1.2 1.51-1.2 2.75v4H8V9h2.5l.5 1.5h.01a3.6 3.6 0 013-1.5c2.4 0 4.5 1.8 4.5 4.75V18z"/></svg>
                        </a>
                        <!-- X/Twitter Icon (Updated to modern X logo shape, clean path) -->
                        <a href="[Sanjeev's X/Twitter]" target="_blank" class="hover:text-accent transition duration-150">
                            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.229-8.26L1 2.25h7.828l3.642 5.022L18.244 2.25zM17.29 19.458l1.764.927.842-.927-2.606-2.72L13.116 8.4h-.008L4.35 19.458l1.764.928.842-.927 2.606-2.72L14.884 8.4h.008l4.56 5.958L17.29 19.458z"/></svg>
                        </a>
                    </div>
                </div>

                <!-- Author 2: Raheel Budha -->
                <div class="flex flex-col items-center text-center">
                    <img src="raheel.png" alt="Raheel Budha Headshot"
                        class="w-36 h-36 rounded-full object-cover border-4 border-accent shadow-md mb-6"
                        onerror="this.onerror=null; this.src='https://placehold.co/150x150/EEEEEE/333333?text=Raheel';"
                    >
                    <h4 class="text-2xl font-bold mb-2">Raheel Budha</h4>
                    <p class="text-sm italic text-gray-500 mb-4">Mind Tuned to Clarity (Precision)</p>
                    <!-- Justified paragraph -->
                    <p class="text-gray-600 mb-4 text-justify">
                        A mind tuned to clarity: to slow down within complexity and reveal the delicate order hidden inside. Raheel's attention moves inward, tracing the subtle lines that connect perception, thought, and meaning. He seeks coherence through stillness, bringing definition where there is depth and light where there is density. For him, awareness is precision, the art of seeing what holds the world together from within.
                    </p>
                    <!-- Social Icons for Raheel -->
                    <div class="flex space-x-5 text-primary-custom">
                         <!-- Facebook Icon (Standard Path) -->
                        <a href="[Raheel's Facebook]" target="_blank" class="hover:text-accent transition duration-150">
                            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12c0 4.84 3.44 8.87 8 9.8V15H7v-3h3V9.5C10 6.47 11.53 4.7 15.56 4.7c1.78 0 3.3.32 3.3.32v3.3h-1.68c-1.54 0-2.02.96-2.02 1.96V12h3.6l-.58 3h-3.02v6.8c4.56-.93 8-4.84 8-9.8z"/></svg>
                        </a>
                        <!-- LinkedIn Icon (Standard Path) -->
                        <a href="[Raheel's LinkedIn]" target="_blank" class="hover:text-accent transition duration-150">
                            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M19 3a2 2 0 012 2v14a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h14zM8 12H5V9h3v3zM6.5 7.5A1.5 1.5 0 005 9.01v.01A1.5 1.5 0 006.5 10.5h.01A1.5 1.5 0 008 9.01v-.01A1.5 1.5 0 006.5 7.5zm11 10.5h-3V14c0-1.24-.54-2-1.2-2.75-.66-.74-1.52-1.25-2.5-1.25s-1.84.51-2.5 1.25c-.66.75-1.2 1.51-1.2 2.75v4H8V9h2.5l.5 1.5h.01a3.6 3.6 0 013-1.5c2.4 0 4.5 1.8 4.5 4.75V18z"/></svg>
                        </a>
                        <!-- X/Twitter Icon (Updated to modern X logo shape, clean path) -->
                        <a href="[Raheel's X/Twitter]" target="_blank" class="hover:text-accent transition duration-150">
                            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.229-8.26L1 2.25h7.828l3.642 5.022L18.244 2.25zM17.29 19.458l1.764.927.842-.927-2.606-2.72L13.116 8.4h-.008L4.35 19.458l1.764.928.842-.927 2.606-2.72L14.884 8.4h.008l4.56 5.958L17.29 19.458z"/></svg>
                        </a>
                    </div>
                </div>
            </div>
            
            <div class="max-w-3xl mx-auto mt-16 text-center text-lg text-gray-600">
                <!-- Quote confirmed as clean -->
                <p>
                    Our collaboration reflects the same principle the book describes: that reality unfolds through delicate equilibrium, through the meeting of perspectives that refine one another until coherence is achieved.
                </p>
            </div>
        </div>
    </section>

    <!-- === 6. FINAL INVITATION & CTA / DIALOGUE (Reworked) === -->
    <section id="contact" class="section-transparent-white py-20 md:py-28 text-center">
        <!-- New, simplified heading -->
        <h3 class="text-3xl sm:text-4xl font-bold mb-6 tracking-tight">
            Share Your Insights
        </h3>
        <p class="text-xl max-w-2xl mx-auto mb-10 text-gray-600">
            The Framework is an ongoing inquiry. Share your reflections, applications, or questions by joining the community dialogue.
        </p>
        <!-- CTA 3: Join Discussion (still rounded-full for visual contrast) -->
        <a href="https://chat.whatsapp.com/LekTStYvWhT7Dwfpbo0MPv" target="_blank"
            class="inline-flex items-center justify-center bg-[var(--color-primary)] text-white py-4 px-10 text-xl font-bold rounded-full shadow-xl hover:bg-indigo-800 transition duration-300 transform hover:translate-y-[-2px]">
            <!-- Clean Chat Bubble SVG Icon -->
            <svg class="w-6 h-6 mr-3" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <!-- Simple speech bubble path -->
                <path d="M20 2H4C2.9 2 2 2.9 2 4v16l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/>
            </svg>
            Join Discussion
        </a>
        <!-- Updated text and mailto link -->
        <p class="mt-8 text-sm text-gray-500">
            For more inquiries, please contact: <a href="mailto:mail@sanjeevkhanal.com.np" class="underline hover:text-primary-custom">mail@sanjeevkhanal.com.np</a>
        </p>
    </section>

    <!-- === 7. FOOTER === -->
    <footer class="footer-transparent-dark text-gray-300 py-10">
        <div class="container mx-auto px-6 flex flex-col sm:flex-row justify-between items-center text-center sm:text-left text-sm max-w-7xl">
            <!-- ISBN Added Here -->
            <p class="mb-2 sm:mb-0">ISBN: 9789937192835 | &copy; 2025 Sanjeev Khanal and Raheel Budha.</p>
            <div class="flex space-x-4 mt-4 sm:mt-0">
                <a href="#hero" class="hover:text-white transition duration-150">Exploration</a>
                <a href="#domains" class="hover:text-white transition duration-150">Domains</a>
                <a href="#authors" class="hover:text-white transition duration-150">Authors</a>
            </div>
        </div>
    </footer>

    <!-- === ORDER CONFIRMATION MODAL (Multi-Step Flow) === -->
    <!-- The structure now hosts two steps dynamically -->
    <div id="order-modal" class="fixed inset-0 z-[100] hidden items-center justify-center modal-overlay" onclick="closeModal()">
        
        <!-- Modal Content Container -->
        <div id="modal-content" class="bg-white rounded-xl shadow-2xl max-w-lg w-full p-6 m-4 transform transition-all duration-300 ease-out scale-100" onclick="event.stopPropagation()">
            <!-- Dynamic content for Step 1 or Step 2 injected here by JS -->
        </div>
    </div>

    <!-- Custom Dialog/Message Box for success/error messages (replaces alert()) -->
    <div id="messageBox" class="fixed top-4 right-4 z-[101] hidden p-4 rounded-lg shadow-xl text-white font-semibold transform transition-all duration-300 translate-x-full" role="alert">
        <span id="messageText"></span>
    </div>


    <!-- === JAVASCRIPT: FUNCTIONALITY & CANVAS ANIMATION === -->
    <script>
        // --- 1. GLOBAL CONSTANTS & ELEMENTS ---
        const BOOK_TITLE = "The Awareness Framework (Paperback)";
        // PRICE UPDATE: Changed to NPR 1500
        const BOOK_PRICE = 1500; 
        const CURRENCY_SYMBOL = "NPR "; // Added currency symbol constant
        // WHATSAPP NUMBER: +977-9705005200 (using digits only for wa.me link)
        const WA_RECIPIENT_NUMBER = "9779705005200"; 

        const modal = document.getElementById('order-modal');
        const modalContent = document.getElementById('modal-content');
        const messageArea = document.getElementById('order-message-area'); // For messages on the main page
        const messageBox = document.getElementById('messageBox'); // For success/error toasts
        const messageText = document.getElementById('messageText');

        // Global State for multi-step flow
        let orderDetails = {
            name: '',
            phoneCode: '+977', // Default to Nepal
            phoneNumber: '',
            country: 'Nepal',
            state: '',
            address: '',
            copies: 1,
        };
        let currentStep = 0; // 0: Closed, 1: Details Entry, 2: Confirmation
        
        // --- 2. UTILITY FUNCTIONS ---
        
        /** Shows a temporary success or error message (replaces alert()) */
        function showToast(message, type = 'error') {
            messageText.textContent = message;
            if (type === 'success') {
                messageBox.className = 'fixed top-4 right-4 z-[101] p-4 rounded-lg shadow-xl text-white bg-green-500 font-semibold transform transition-all duration-300 translate-x-0';
            } else {
                messageBox.className = 'fixed top-4 right-4 z-[101] p-4 rounded-lg shadow-xl text-white bg-red-500 font-semibold transform transition-all duration-300 translate-x-0';
            }
            messageBox.style.display = 'block';
            
            // Hide after 3 seconds
            setTimeout(() => {
                messageBox.className = 'fixed top-4 right-4 z-[101] p-4 rounded-lg shadow-xl text-white font-semibold transform transition-all duration-300 translate-x-full';
            }, 3000);
            // Hide element fully after transition
            setTimeout(() => {
                messageBox.style.display = 'none';
            }, 3500);
        }

        /** Closes the modal and resets the step */
        function closeModal() {
            modal.classList.add('hidden');
            modal.classList.remove('flex');
            currentStep = 0;
        }

        /** Displays the modal and renders content for the specified step */
        function showModal(step) {
            currentStep = step;
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            
            if (step === 1) {
                renderStep1();
            } else if (step === 2) {
                renderStep2();
            }
            
            // Clear main page message area when modal opens
            messageArea.innerHTML = '';
        }


        // --- 3. STEP 1: DETAILS ENTRY ---

        function renderStep1() {
            modalContent.innerHTML = `
                <div class="p-4 sm:p-8">
                    <h2 class="text-2xl font-bold text-primary-custom mb-2 border-b pb-2">1. Shipping Details</h2>
                    <p class="text-sm text-gray-500 mb-6">Enter your address and contact information for the order.</p>
                    
                    <form id="detailsForm" onsubmit="event.preventDefault(); proceedToConfirm();">
                        <!-- Name -->
                        <div class="mb-4">
                            <label for="name" class="block text-sm font-medium text-gray-700 mb-1">Full Name</label>
                            <input type="text" id="name" value="${orderDetails.name}" required
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-accent focus:border-accent transition duration-150" placeholder="Ram Bahadur Magar">
                        </div>

                        <!-- Phone Number -->
                        <div class="mb-4">
                            <label for="phoneNumber" class="block text-sm font-medium text-gray-700 mb-1">Phone Number (Required for WA Order)</label>
                            <div class="flex gap-2">
                                <select id="phoneCode" class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-accent focus:border-accent">
                                    <option value="+977" ${orderDetails.phoneCode === '+977' ? 'selected' : ''}>+977 (NP)</option>
                                    <option value="+91" ${orderDetails.phoneCode === '+91' ? 'selected' : ''}>+91 (IN)</option>
                                    <option value="+1" ${orderDetails.phoneCode === '+1' ? 'selected' : ''}>+1 (US/CA)</option>
                                    <option value="+44" ${orderDetails.phoneCode === '+44' ? 'selected' : ''}>+44 (UK)</option>
                                </select>
                                <input type="tel" id="phoneNumber" value="${orderDetails.phoneNumber}" required
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-accent focus:border-accent transition duration-150" placeholder="9876543210">
                            </div>
                        </div>

                        <!-- Country and State -->
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4">
                            <div>
                                <label for="country" class="block text-sm font-medium text-gray-700 mb-1">Country</label>
                                <select id="country" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-accent focus:border-accent">
                                    <option value="Nepal" ${orderDetails.country === 'Nepal' ? 'selected' : ''}>Nepal</option>
                                    <option value="India" ${orderDetails.country === 'India' ? 'selected' : ''}>India</option>
                                    <option value="Other" ${orderDetails.country === 'Other' ? 'selected' : ''}>Other</option>
                                </select>
                            </div>
                            <div>
                                <label for="state" class="block text-sm font-medium text-gray-700 mb-1">State/Province</label>
                                <input type="text" id="state" value="${orderDetails.state}" required
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-accent focus:border-accent transition duration-150" placeholder="e.g., Bagmati, Kathmandu">
                            </div>
                        </div>

                        <!-- Shipping Address -->
                        <div class="mb-6">
                            <label for="address" class="block text-sm font-medium text-gray-700 mb-1">Full Shipping Address</label>
                            <textarea id="address" rows="3" required
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-accent focus:border-accent transition duration-150" 
                                placeholder="Street Address, City, Zip Code / Area">${orderDetails.address}</textarea>
                        </div>
                        
                        <!-- Buttons -->
                        <div class="flex justify-end gap-3">
                            <button type="button" onclick="closeModal()" class="px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-100 transition duration-150">
                                Cancel
                            </button>
                            <button type="submit" class="px-6 py-2 bg-[var(--color-primary)] text-white font-semibold rounded-lg shadow-md hover:bg-indigo-700 transition duration-150">
                                Proceed to Confirm &rarr;
                            </button>
                        </div>
                    </form>
                </div>
            `;
        }

        /** Collects data from Step 1 form, validates it, and moves to Step 2 */
        function proceedToConfirm() {
            const name = document.getElementById('name').value.trim();
            const phoneCode = document.getElementById('phoneCode').value.trim();
            const phoneNumber = document.getElementById('phoneNumber').value.trim();
            const country = document.getElementById('country').value.trim();
            const state = document.getElementById('state').value.trim();
            const address = document.getElementById('address').value.trim();

            // Simple validation
            if (!name || !phoneNumber || !country || !state || !address) {
                showToast("Please fill out all necessary details", 'error');
                return;
            }
            
            // Basic phone number length validation (adjust as needed for specific markets)
            if (phoneNumber.length < 7 || phoneNumber.length > 15) {
                showToast("Please check the phone number length.", 'error');
                return;
            }

            // Update global state, retaining the last selected copies count
            orderDetails = { name, phoneCode, phoneNumber, country, state, address, copies: orderDetails.copies };
            
            // Move to step 2
            showModal(2);
        }
        
        // --- 4. STEP 2: CONFIRMATION & QUANTITY ---

        function renderStep2() {
            const { name, phoneCode, phoneNumber, country, state, address, copies } = orderDetails;
            
            modalContent.innerHTML = `
                <div class="p-4 sm:p-8">
                    <h2 class="text-2xl font-bold text-primary-custom mb-2 border-b pb-2">2. Confirm Order and Quantity</h2>
                    <p class="text-sm text-gray-500 mb-6">Review your details and select the number of copies</p>
                    
                    <!-- Confirmation Details Box -->
                    <div class="bg-gray-50 p-4 rounded-lg mb-6 confirmation-scroll border border-gray-200">
                        <h3 class="font-semibold text-lg text-gray-700 mb-3">Shipping Information Summary:</h3>
                        <div class="space-y-2 text-sm text-gray-600">
                            <p><strong>Recipient:</strong> ${name}</p>
                            <p><strong>Phone:</strong> <span class="text-green-600 font-medium">${phoneCode}${phoneNumber}</span> (For WhatsApp)</p>
                            <p><strong>Location:</strong> ${address}, ${state}, ${country}</p>
                        </div>

                        <h3 class="font-semibold text-lg text-gray-700 mt-4 mb-3">Product:</h3>
                        <p class="text-sm text-gray-600"><strong>${BOOK_TITLE}</strong></p>
                        <!-- Price updated to use new constant and currency symbol -->
                        <p class="text-sm text-gray-600">Price: ${CURRENCY_SYMBOL}${BOOK_PRICE.toLocaleString()} </p>
                    </div>

                    <!-- Number of Copies Selector -->
                    <div class="mb-6 flex items-center justify-between p-3 bg-white border border-[var(--color-primary)] rounded-lg shadow-sm">
                        <label for="copies" class="block text-base font-semibold text-gray-700">Number of Copies:</label>
                        <select id="copies" onchange="orderDetails.copies = parseInt(this.value);" 
                            class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-accent focus:border-accent text-lg font-bold">
                            <!-- Generate options for 1 to 10 copies -->
                            ${[...Array(10).keys()].map(i => i + 1).map(num => 
                                `<option value="${num}" ${copies === num ? 'selected' : ''}>${num}</option>`
                            ).join('')}
                        </select>
                    </div>

                    <!-- Buttons -->
                    <div class="flex justify-between gap-3">
                        <button type="button" onclick="showModal(1)" class="px-4 py-2 text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200 transition duration-150">
                            &larr; Edit Details
                        </button>
                        <button type="button" onclick="placeOrderViaWhatsapp()" 
                                class="flex items-center gap-2 px-6 py-3 bg-green-500 text-white font-bold rounded-lg shadow-lg hover:bg-green-600 transition duration-150 transform hover:scale-[1.01]">
                            <!-- WhatsApp Icon (inline SVG) -->
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M12.04 2c-5.46 0-9.91 4.45-9.91 9.91 0 1.75.46 3.45 1.34 4.97l-1.4 5.15 5.23-1.37c1.45.79 3.08 1.21 4.74 1.21 5.46 0 9.91-4.45 9.91-9.91s-4.45-9.91-9.91-9.91zm.04 18.02c-1.42 0-2.8-.39-3.99-1.14l-.28-.17-2.92.77.78-2.85-.19-.3c-.83-1.35-1.27-2.92-1.27-4.52 0-4.63 3.77-8.4 8.4-8.4s8.4 3.77 8.4 8.4-3.77 8.4-8.4 8.4zm4.1-6.19c-.23-.12-.87-.44-.99-.48s-.25-.06-.35.06-.4.48-.49.58-.17.11-.31.06c-.14-.06-.59-.22-1.12-.69-.41-.36-.69-.8-1.01-1.34-.31-.54-.03-.5-.07-.54s-.35-.04-.48-.04-.25-.01-.35.05c-.1.06-.17.18-.26.28-.08.1-.17.19-.25.28-.08.1-.17.07-.31 0s-.6-.22-1.14-.68c-.54-.45-.9-.87-1.27-1.44-.37-.56-.1-.58-.28-.58h-.06c-.18 0-.48.06-.63.22-.15.15-.58.55-.58 1.33s.6 1.54.68 1.65.25.12.44.33c.19.2.39.48.59.69.2.2.39.33.56.44.86.58 1.75.87 2.65.87 2.11 0 4.01-1.57 4.74-2.83.23-.39.23-.74.16-.87-.06-.13-.23-.2-.48-.33z"/></svg>
                            Place Order via WhatsApp
                        </button>
                    </div>
                </div>
            `;
        }
        
        /** Generates the pre-filled WhatsApp message URL and opens it */
        function placeOrderViaWhatsapp() {
            const { name, phoneCode, phoneNumber, country, state, address, copies } = orderDetails;
            
            // 1. Construct the message content
            const messageTemplate = `
* --- NEW ORDER RECEIVED ---*
*The Awareness Framework:* ${copies} Copies
*Total Amount:* ${CURRENCY_SYMBOL}${(copies * BOOK_PRICE).toLocaleString()}

--- CUSTOMER DETAIL ---
Name: ${name}
Phone: ${phoneCode}${phoneNumber}
Shipping Address: ${address}
Location: ${state}, ${country}

            `.trim();
            
            // 2. Encode the message for the URL
            const encodedMessage = encodeURIComponent(messageTemplate);
            
            // 3. Construct the WhatsApp API URL
            const whatsappUrl = `https://wa.me/${WA_RECIPIENT_NUMBER}?text=${encodedMessage}`;
            
            // 4. Provide feedback and close the modal
            closeModal();
            showToast(`Opening WhatsApp chat. Please confirm the pre-filled message.`, 'success');
            
            // 5. Open the WhatsApp link
            window.open(whatsappUrl, '_blank');
        }

        
        // --- 5. CANVAS ANIMATION LOGIC (Retained from original file) ---
        const canvas = document.getElementById('awarenessCanvas');
        
        if (canvas) {
            const ctx = canvas.getContext('2d');
            let rings = [];
            
            const MAX_RINGS = 30; 
            const RING_RGB = '13, 17, 55'; 
            const VISIBILITY_FACTOR = 0.20; 
            const GENERATION_INTERVAL_FRAMES = 100; 
            const RING_SPAWN_RADIUS = 5; 
            const RING_SPEED = 0.2; 

            function resizeCanvas() {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            }
            resizeCanvas();
            window.addEventListener('resize', resizeCanvas); 

            function Ring(x, y) {
                this.x = x;
                this.y = y;
                this.radius = RING_SPAWN_RADIUS; 
                this.opacity = 1;
                this.speed = RING_SPEED; 
                this.maxRadius = Math.max(window.innerWidth, window.innerHeight) * 0.4;
            }

            Ring.prototype.update = function() {
                this.radius += this.speed;
                this.opacity = 1 - ((this.radius - RING_SPAWN_RADIUS) / (this.maxRadius - RING_SPAWN_RADIUS));
            };

            Ring.prototype.draw = function() {
                const currentOpacity = this.opacity * VISIBILITY_FACTOR; 
                const shadowOpacity = currentOpacity * 0.4; 

                ctx.shadowColor = 'rgba(' + RING_RGB + ', ' + shadowOpacity + ')';
                ctx.shadowBlur = 12; 
                ctx.shadowOffsetX = 0;
                ctx.shadowOffsetY = 0;

                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2, false);
                
                ctx.strokeStyle = 'rgba(' + RING_RGB + ', ' + currentOpacity + ')'; 
                ctx.lineWidth = 10; 
                ctx.stroke();

                ctx.shadowBlur = 0; 
                ctx.shadowColor = 'transparent'; 
            };
            
            function initializePerpetualField() {
                const radiusIncrement = RING_SPEED * GENERATION_INTERVAL_FRAMES; 
                const centerX = canvas.width / 2;
                const centerY = canvas.height / 2;

                for (let i = 0; i < MAX_RINGS; i++) {
                    const ring = new Ring(centerX, centerY);
                    ring.radius = (i * radiusIncrement) + RING_SPAWN_RADIUS; 
                    ring.opacity = 1 - ((ring.radius - RING_SPAWN_RADIUS) / (ring.maxRadius - RING_SPAWN_RADIUS));
                    
                    if (ring.opacity > 0) {
                        rings.push(ring);
                    }
                }
            }

            let frameCount = 0;
            function animate() {
                // Clear canvas with a slight transparency for the trail effect
                ctx.fillStyle = 'rgba(255, 255, 255, 0.2)'; 
                ctx.fillRect(0, 0, canvas.width, canvas.height); 

                if (frameCount % GENERATION_INTERVAL_FRAMES === 0 && rings.length < MAX_RINGS) { 
                    const centerX = canvas.width / 2;
                    const centerY = canvas.height / 2;
                    rings.push(new Ring(centerX, centerY)); 
                }

                for (let i = 0; i < rings.length; i++) {
                    rings[i].update();
                    rings[i].draw();

                    if (rings[i].radius >= rings[i].maxRadius || rings[i].opacity <= 0) {
                        rings.splice(i, 1);
                        i--;
                    }
                }
                
                frameCount++;
                requestAnimationFrame(animate);
            }
            
            initializePerpetualField();
            animate();
        }
        
        // --- 6. INITIALIZATION AND EVENT LISTENERS ---
        
        // Listen for mobile menu toggle
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileNav = document.getElementById('mobile-nav');
        
        if (mobileMenuButton && mobileNav) {
            mobileMenuButton.addEventListener('click', () => {
                mobileNav.classList.toggle('hidden');
            });
            // Close menu when a link is clicked
            mobileNav.querySelectorAll('a').forEach(link => {
                link.addEventListener('click', () => {
                    mobileNav.classList.add('hidden');
                });
            });
        }
        
        // Event listener to close modal when clicking outside (on the overlay)
        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                closeModal();
            }
        });

    </script>
</body>
</html>
